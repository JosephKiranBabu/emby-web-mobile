define(["actionsheet","datetime","playbackManager","globalize","appSettings"],function(actionsheet,datetime,playbackManager,globalize,appSettings){"use strict";function show(options){var item=options.item,itemType=item.Type,mediaType=item.MediaType,isFolder=item.IsFolder,itemId=item.Id,channelId=item.ChannelId,serverId=item.ServerId,resumePositionTicks=item.UserData?item.UserData.PlaybackPositionTicks:null,showExternalPlayer=isMobileApp&&"Video"===mediaType&&!isFolder&&appSettings.enableExternalPlayers(),playableItemId="Program"===itemType?channelId:itemId;if(!resumePositionTicks&&"Audio"!==mediaType&&!isFolder&&!showExternalPlayer)return void playbackManager.play({ids:[playableItemId],serverId:serverId});var menuItems=[];resumePositionTicks?(menuItems.push({name:globalize.translate("sharedcomponents#ResumeAt",datetime.getDisplayRunningTime(resumePositionTicks)),id:"resume"}),menuItems.push({name:globalize.translate("sharedcomponents#PlayFromBeginning"),id:"play"})):menuItems.push({name:globalize.translate("sharedcomponents#Play"),id:"play"}),showExternalPlayer&&menuItems.push({name:globalize.translate("ButtonPlayExternalPlayer"),id:"externalplayer"}),playbackManager.canQueue(item)&&menuItems.push({name:globalize.translate("sharedcomponents#Queue"),id:"queue"}),"Audio"!==itemType&&"MusicAlbum"!==itemType&&"MusicArtist"!==itemType&&"MusicGenre"!==itemType||menuItems.push({name:globalize.translate("sharedcomponents#InstantMix"),id:"instantmix"}),(isFolder||"MusicArtist"===itemType||"MusicGenre"===itemType)&&menuItems.push({name:globalize.translate("sharedcomponents#Shuffle"),id:"shuffle"}),actionsheet.show({items:menuItems,positionTo:options.positionTo}).then(function(id){switch(id){case"play":playbackManager.play({ids:[playableItemId],serverId:serverId});break;case"externalplayer":LibraryBrowser.playInExternalPlayer(playableItemId);break;case"resume":playbackManager.play({ids:[playableItemId],startPositionTicks:resumePositionTicks,serverId:serverId});break;case"queue":playbackManager.queue(item);break;case"instantmix":playbackManager.instantMix(item);break;case"shuffle":playbackManager.shuffle(item)}})}var isMobileApp=null!=window.Dashboard;return{show:show}});
define(["datetime","dom","seriesRecordingEditor","listView","emby-itemscontainer"],function(datetime,dom,seriesRecordingEditor,listView){return function(view,params){function renderTimer(page,item){page.querySelector(".itemName").innerHTML=item.Name,Dashboard.hideLoadingMsg()}function getProgramScheduleHtml(items,options){options=options||{};var html="";return html+='<div is="emby-itemscontainer" class="itemsContainer vertical-list" data-contextmenu="false">',html+=listView.getListViewHtml({items:items,enableUserDataButtons:!1,image:!1,showProgramDateTime:!0,mediaInfo:!1,action:"none",moreButton:!1,recordButton:!1}),html+="</div>"}function renderSchedule(page){ApiClient.getLiveTvTimers({UserId:ApiClient.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",SortBy:"StartDate",EnableTotalRecordCount:!1,EnableUserData:!1,SeriesTimerId:params.id,Fields:"ChannelInfo"}).then(function(result){result.Items.length&&result.Items[0].SeriesTimerId!=params.id&&(result.Items=[]);var html=getProgramScheduleHtml(result.Items),scheduleTab=page.querySelector(".scheduleTab");scheduleTab.innerHTML=html,ImageLoader.lazyChildren(scheduleTab)})}function reload(){var id=params.id;Dashboard.showLoadingMsg(),ApiClient.getLiveTvSeriesTimer(id).then(function(result){renderTimer(view,result)}),renderSchedule(view)}seriesRecordingEditor.embed(params.id,ApiClient.serverId(),{context:view.querySelector(".recordingEditor")}),view.querySelector(".scheduleTab").addEventListener("timercancelled",reload),view.addEventListener("viewbeforeshow",reload)}});